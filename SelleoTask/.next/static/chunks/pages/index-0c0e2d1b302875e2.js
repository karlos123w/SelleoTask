(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{6540:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var s=r(n(4938)),o=n(5893);t.Z=(0,s.default)((0,o.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},6534:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var s=r(n(4938)),o=n(5893);t.Z=(0,s.default)((0,o.jsx)("path",{d:"M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m-6 12v-3h-4v-4h4V8l5 5z"}),"DriveFileMove")},5512:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var s=r(n(4938)),o=n(5893);t.Z=(0,s.default)((0,o.jsx)("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8z"}),"Folder")},4634:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var s=r(n(4938)),o=n(5893);t.Z=(0,s.default)((0,o.jsx)("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm7 7V3.5L18.5 9z"}),"InsertDriveFile")},3540:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var s=r(n(4938)),o=n(5893);t.Z=(0,s.default)((0,o.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout")},4938:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(1109)},1109:function(e,t,n){"use strict";n.r(t),n.d(t,{capitalize:function(){return s.Z},createChainedFunction:function(){return o},createSvgIcon:function(){return i.Z},debounce:function(){return a.Z},deprecatedPropType:function(){return u},isMuiElement:function(){return c.Z},ownerDocument:function(){return l.Z},ownerWindow:function(){return d.Z},requirePropFactory:function(){return f},setRef:function(){return p},unstable_ClassNameGenerator:function(){return k},unstable_useEnhancedEffect:function(){return h.Z},unstable_useId:function(){return v},unsupportedProp:function(){return g},useControlled:function(){return Z.Z},useEventCallback:function(){return m.Z},useForkRef:function(){return w.Z},useIsFocusVisible:function(){return x.Z}});var r=n(1983),s=n(8216),o=n(5725).Z,i=n(8169),a=n(7144),u=function(e,t){return()=>null},c=n(6476),l=n(8038),d=n(5340);n(7462);var f=function(e,t){return()=>null},p=n(5091).Z,h=n(8974),v=n(9326).Z,g=function(e,t,n,r,s){return null},Z=n(7388),m=n(2068),w=n(1705),x=n(9632);let k={configure:e=>{r.Z.configure(e)}}},8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5588)}])},5588:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(5893),s=n(7294),o=n(948),i=n(1233),a=n(9417),u=n(2819),c=n(8912),l=n(1163),d=n(5121);let f={getAllFoldersAndFiles:async()=>{try{var e,t;let n=await d.Z.get("/files/find-files");return{ok:!0,status:n.status,message:null!==(e=n.data.message)&&void 0!==e?e:"success",dirs:null!==(t=n.data)&&void 0!==t?t:[]}}catch(n){console.log(n);let e="Something went wrong",t=400;return"AxiosError: Network Error"===e&&(e="Network connection lost"),d.Z.isAxiosError(n)&&n.response&&(404===n.response.status&&(e="Item not found!"),403===n.response.status&&(e="Action forbidden!"),n.response.status&&(t=n.response.status)),{message:e,status:t,ok:!1,dirs:[]}}},createDir:async e=>{try{var t;let n=await d.Z.post("/files/create-directory/".concat(e));return{ok:!0,status:n.status,message:null!==(t=n.data.message)&&void 0!==t?t:"success"}}catch(n){console.log(n);let e="Something went wrong",t=400;return"AxiosError: Network Error"===e&&(e="Network connection lost"),d.Z.isAxiosError(n)&&n.response&&(409===n.response.status&&(e="Dir already exist!"),404===n.response.status&&(e="Item not found!"),403===n.response.status&&(e="Action forbidden!"),n.response.status&&(t=n.response.status)),{message:e,status:t,ok:!1}}},addFile:async(e,t)=>{d.Z.defaults.headers.post["Content-Type"]="multipart/form-data";try{var n;let r=await d.Z.post("/files/".concat(t,"/add-file"),e),s={ok:!0,status:r.status,message:null!==(n=r.data.message)&&void 0!==n?n:"success"};return d.Z.defaults.headers.post["Content-Type"]="application/json",s}catch(n){console.log(n);let e="Something went wrong",t=400;return"AxiosError: Network Error"===e&&(e="Network connection lost"),d.Z.isAxiosError(n)&&n.response&&(409===n.response.status&&(e="File already exist!"),404===n.response.status&&(e="Item not found!"),403===n.response.status&&(e="Action forbidden!"),n.response.status&&(t=n.response.status)),d.Z.defaults.headers.post["Content-Type"]="application/json",{message:e,status:t,ok:!1}}}};var p=n(4634);let h=(0,o.ZP)("div")({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"fit-content",textAlign:"center"});var v=e=>{let{file:t}=e;return(0,r.jsxs)(h,{children:[(0,r.jsx)(p.Z,{}),(0,r.jsx)("div",{children:t.name})]})},g=n(5512),Z=n(6534),m=n(6949),w=n(7036),x=n(6540);let k=(0,o.ZP)("div")({}),j=(0,o.ZP)("div")({display:"flex",alignItems:"center","&:hover":{cursor:"pointer"}}),y=(0,o.ZP)("div")({display:"flex",alignItems:"center",justifyContent:"center",width:44,aspectRatio:1,color:m.Z["400"],fontSize:42});var E=e=>{let{dir:t,refreshFiles:n}=e,[o,a]=(0,s.useState)(!1),[u,c]=(0,s.useState)(!1),l=()=>t.dirname.split("./uploads/")[1],d=()=>{a(!o)},p=async()=>{let e=document.createElement("input");e.type="file",e.addEventListener("change",async e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){console.log(r);let e=await f.addFile({file:r},l());if(!e.ok)return window.alert(e.message);n(),a(!0)}}),e.click()};return(0,r.jsxs)(k,{children:[(0,r.jsxs)(j,{onMouseOut:()=>c(!1),onMouseOver:()=>c(!0),children:[(0,r.jsx)(y,{onClick:d,children:o?(0,r.jsx)(Z.Z,{color:"inherit",fontSize:"inherit"}):(0,r.jsx)(g.Z,{color:"inherit",fontSize:"inherit"})}),(0,r.jsx)("div",{onClick:d,children:l()}),u&&(0,r.jsx)(i.Z,{children:(0,r.jsx)(y,{onClick:p,children:(0,r.jsx)(x.Z,{})})})]}),o&&(0,r.jsxs)(i.Z,{paddingLeft:2,rowGap:2,columnGap:2,direction:"row",flexWrap:"wrap",color:w.Z["700"],padding:2,children:[t.files.map(e=>(0,r.jsx)(v,{file:e},e.name)),0===t.files.length&&(0,r.jsx)("div",{style:{color:"grey",fontStyle:"italic",fontSize:18},children:"no files"})]})]})},A=n(3540);let S=(0,o.ZP)("div")({});var I=e=>{let t=(0,l.useRouter)(),[n,o]=(0,s.useState)([]),d=(0,s.useCallback)(async()=>{let e=await f.getAllFoldersAndFiles();if(!e.ok)return window.alert(e.message);o(e.dirs)},[]),p=async()=>{let e=window.prompt("Type dirname");if(!e)return;let t=await f.createDir(e);if(!t.ok)return window.alert(t.message);d()};return(0,s.useEffect)(()=>{c.Q.checkUserInSession()?d():t.push("/login")},[d,t]),(0,r.jsxs)(u.Z,{children:[(0,r.jsxs)(i.Z,{padding:1,spacing:1,direction:"row",children:[(0,r.jsx)(a.Z,{variant:"contained",startIcon:(0,r.jsx)(x.Z,{}),onClick:p,children:"New directory"}),(0,r.jsx)(a.Z,{variant:"text",color:"error",startIcon:(0,r.jsx)(A.Z,{}),onClick:()=>{window.confirm("Logout?")&&(c.Q.logout(),t.push("/login"))},children:"Logout"})]}),(0,r.jsx)(S,{children:n.map(e=>(0,r.jsx)(E,{dir:e,refreshFiles:d},e.dirname))})]})}},8912:function(e,t,n){"use strict";n.d(t,{Q:function(){return s}});var r=n(5121);let s={login:async e=>{try{var t,n;let s=await r.Z.post("/auth/login",e);return{ok:!0,status:s.status,message:null!==(t=s.data.message)&&void 0!==t?t:"success",user:null!==(n=s.data)&&void 0!==n?n:null}}catch(n){console.log(n);let e="Something went wrong",t=400;return"AxiosError: Network Error"===e&&(e="Network connection lost"),r.Z.isAxiosError(n)&&n.response&&(404===n.response.status&&(e="Item not found!"),403===n.response.status&&(e="Action forbidden!"),n.response.status&&(t=n.response.status)),{message:e,status:t,ok:!1,user:null}}},saveUserInSession:e=>{let t=JSON.stringify(e);sessionStorage.setItem("user",t),r.Z.defaults.headers.common.Authorization="Bearer ".concat(e.token)},checkUserInSession:()=>{let e=sessionStorage.getItem("user");if(!e)return null;{let t=JSON.parse(e);return r.Z.defaults.headers.common.Authorization="Bearer ".concat(t.token),t}},logout:()=>{r.Z.defaults.headers.common.Authorization="",sessionStorage.removeItem("user")},register:async e=>{try{var t,n;let s=await r.Z.post("/users/register",e);return{ok:!0,status:s.status,message:null!==(t=s.data.message)&&void 0!==t?t:"success",user:null!==(n=s.data)&&void 0!==n?n:null}}catch(n){console.log(n);let e="Something went wrong",t=400;return"AxiosError: Network Error"===e&&(e="Network connection lost"),r.Z.isAxiosError(n)&&n.response&&(404===n.response.status&&(e="Item not found!"),403===n.response.status&&(e="Action forbidden!"),n.response.status&&(t=n.response.status)),{message:e,status:t,ok:!1,user:null}}}}},2819:function(e,t,n){"use strict";var r=n(5893),s=n(948),o=n(5582);let i=(0,s.ZP)("div")({});t.Z=e=>{let{children:t}=e;return(0,r.jsx)(i,{children:(0,r.jsx)(o.Z,{children:t})})}}},function(e){e.O(0,[432,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);